{"version":3,"sources":["../../src/template/controller.ts"],"sourcesContent":["export default (name: string) => {\n  const filename = name.replace(/^\\S/, (s) => {\n    return s.toUpperCase();\n  });\n  return `\n'use strict';\n\nconst BaseController = require('./BaseController');\n\nclass ${filename}Controller extends BaseController {\n  /**\n   * 查询数据\n   * @接口格式 /${name}\n   * @请求方法 GET请求\n   * @example /${name}?limit=10&...\n   */\n  async index() {\n    const { ctx } = this;\n    const body = ctx.request.query;\n\n    try {\n      const query = {\n        where: ctx.helper.filterLimit(body),\n        limit: ctx.helper.toInt(body.limit),\n        offset: ctx.helper.toInt(body.offset),\n      };\n      const data = await ctx.model.${filename}.findAll(query);\n      this.success({ list: data });\n    } catch (err) {\n      this.fail(500, err);\n    }\n  }\n  /**\n   * 查询对应id数据\n   * @接口格式 /data/id\n   * @请求方法 GET请求\n   */\n  async show() {\n    const ctx = this.ctx;\n    const id = ctx.helper.toInt(ctx.params.id);\n    try {\n      const list = await ctx.model.${filename}.findByPk(id);\n      this.success({ list });\n    } catch (err) {\n      this.fail(500, err);\n    }\n  }\n  /**\n   * 新增\n   * @接口格式 /data\n   * @请求方法 POST请求\n   */\n  async create() {\n    const { ctx } = this;\n    const body = ctx.request.body;\n    try {\n      const user = await ctx.model.${filename}.create(body);\n      this.success(user);\n    } catch (err) {\n      this.fail(500, err);\n    }\n  }\n\n  /**\n   * 更新\n   * @接口格式 /${name}/id\n   * @请求方法 PUT请求\n   */\n  async update() {\n    const ctx = this.ctx;\n    const id = ctx.helper.toInt(ctx.params.id);\n    try {\n      const data = await ctx.model.${filename}.findByPk(id);\n      if (!data) {\n        this.fail(404, '没有查询到对应ID=${'id'}的数据');\n        return;\n      }\n      const body = ctx.request.body;\n      await data.update(body);\n      this.success(data);\n    } catch (err) {\n      this.fail(500, err);\n    }\n  }\n\n  /**\n   * 删除\n   * @接口格式 /${name}/id\n   * @请求方法 DELETE请求\n   */\n  async destroy() {\n    const ctx = this.ctx;\n    const id = ctx.helper.toInt(ctx.params.id);\n    try {\n      const user = await ctx.model.${filename}.findByPk(id);\n      if (!user) {\n        this.fail(404, '没有查询到对应ID=${'id'}的数据');\n        return;\n      }\n      await user.destroy();\n      this.success(user);\n    } catch (err) {\n      this.fail(500, err);\n    }\n  }\n}\nmodule.exports = ${filename}Controller;\n`;\n};\n"],"names":["name","filename","replace","s","toUpperCase"],"mappings":";;;;;gBAAgBA,IAAY,GAAK,CAAC;IAChC,KAAK,CAACC,QAAQ,GAAGD,IAAI,CAACE,OAAO,SAASC,CAAC,GAAK,CAAC;QAC3C,MAAM,CAACA,CAAC,CAACC,WAAW;IACtB,CAAC;IACD,MAAM,EAAE,2EAKJ,EAAEH,QAAQ,CAAC,gFAGL,EAAUD,IAAI,CAAC,6CAEJ,EAANA,IAAI,CAAC,0TAYa,EAAEC,QAAQ,CAAC,qVAeX,EAAEA,QAAQ,CAAC,kTAeX,EAAEA,QAAQ,CAAC,yIASlC,EAAUD,IAAI,CAAC,iLAOgB,EAANC,QAAQ,CAAC,kFAEZ,EAAgB,CAAI,IAAC,mOAa7B,EAAJD,IAAI,CAAC,qLAOgB,EAANC,QAAQ,CAAC,kFAEZ,EAAgB,CAAI,IAAC,uKAUxB,EAAEA,QAAQ,CAAC,YAC5B;AACA,CAAC"}